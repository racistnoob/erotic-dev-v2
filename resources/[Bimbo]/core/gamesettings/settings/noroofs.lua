local roofs = {
    {
        name = "roof_a1",
        points = {
            vector2(-88.26, -1473.48),
            vector2(-128.03, -1439.77),
            vector2(-154.55, -1466.29),
            vector2(-114.77, -1501.52)
        },
        options = {
            maxZ = 45.0,
            minZ = 35.0
        },
    },

    {
        name = "roof_b1b2",
        points = {
            vector2(-73.11, -1492.80),
            vector2(-1.14, -1549.24),
            vector2(-26.89, -1575.76),
            vector2(-95.83, -1518.18)
        },
        options = {
            maxZ = 45.0,
            minZ = 35.0
        },
    },

    {
        name = "roof_church",
        points = {
            vector2(1.14, -1478.79),
            vector2(-9.09, -1492.05),
            vector2(3.41, -1501.52),
            vector2(0.00, -1506.82),
            vector2(14.39, -1517.42),
            vector2(29.55, -1502.65)
        },
        options = {
            maxZ = 45.0,
            minZ = 32.0
        },
    },

    {
        name = "roof_whitechamberlain",
        points = {
            vector2(-123.86, -1554.55),
            vector2(-96.97, -1575.76),
            vector2(-129.55, -1615.53),
            vector2(-167.80, -1601.89)
        },
        options = {
            maxZ = 45.0,
            minZ = 36.0
        },
    },
    {
        name = "roof_pinktocouch",
        points = {
            vector2(-87.50, -1584.74),
            vector2(-57.95, -1611.36),
            vector2(-138.26, -1705.30),
            vector2(-149.24, -1696.59),
            vector2(-144.70, -1690.91),
            vector2(-156.82, -1680.68),
            vector2(-162.88, -1683.71),
            vector2(-166.18, -1673.86)
        },
        options = {
            maxZ = 45.0,
            minZ = 35.0
        },
    },

    {
        name = "roof_baseball",
        points = {
            vector2(-257.58, -1503.79),
            vector2(-263.64, -1510.98),
            vector2(-262.12, -1516.29),
            vector2(-260.98, -1518.56),
            vector2(-260.61, -1522.35),
            vector2(-247.73, -1512.50)
        },
        options = {
            maxZ = 43.0,
            minZ = 35.0
        },
    },

    {
        name = "roof_c1",
        points = {
            vector2(-151.14, -1533.71),
            vector2(-175.00, -1514.39),
            vector2(-215.15, -1554.17),
            vector2(-187.12, -1581.44)
        },
        options = {
            maxZ = 43.0,
            minZ = 37.0
        },
    },
    {
        name = "roof_c2",
        points = {
            vector2(-228.79, -1578.41),
            vector2(-237.50, -1578.79),
            vector2(-236.36, -1632.20),
            vector2(-228.79, -1631.44)
        },
        options = {
            maxZ = 43.0,
            minZ = 36.0
        },
    },
    {
        name = "roof_c3",
        points = {
            vector2(-198.11, -1685.23),
            vector2(-198.86, -1636.74),
            vector2(-217.42, -1636.74),
            vector2(-235.98, -1636.36),
            vector2(-236.36, -1684.85)
        },
        options = {
            maxZ = 43.0,
            minZ = 36.0
        },
    },

    {
        name = "roof_weedshop",
        points = {
            vector2(-199.62, -1698.86),
            vector2(-212.88, -1711.36),
            vector2(-193.56, -1725.00),
            vector2(-190.91, -1707.95)
        },
        options = {
            maxZ = 43.0,
            minZ = 34.0
        },
    },

    {
        name = "roof_dollarpills",
        points = {
            vector2(123.86, -1573.86),
            vector2(143.94, -1588.64),
            vector2(131.06, -1604.55),
            vector2(116.67, -1593.94),
            vector2(110.61, -1601.14),
            vector2(103.79, -1607.95),
            vector2(98.48, -1604.17),
            vector2(73.86, -1631.06),
            vector2(38.26, -1598.48),
            vector2(78.03, -1550.38),
            vector2(87.12, -1540.91),
            vector2(110.23, -1561.36),
            vector2(107.58, -1567.42),
            vector2(118.94, -1577.65)
        },
        options = {
            maxZ = 37.0,
            minZ = 30.0
        },
    },

    {
        name = "roof_flowers",
        points = {
            vector2(131.06, -1496.59),
            vector2(123.48, -1491.67),
            vector2(118.56, -1485.61),
            vector2(109.47, -1484.47),
            vector2(90.53, -1503.03),
            vector2(90.53, -1511.36),
            vector2(111.36, -1528.79),
            vector2(134.47, -1504.92)
        },
        options = {
            maxZ = 37.0,
            minZ = 30.0
        },
    },

    {
        name = "roof_firestation",
        points = {
            vector2(187.88, -1642.80),
            vector2(180.30, -1649.62),
            vector2(212.50, -1677.27),
            vector2(219.32, -1668.56)
        },
        options = {
            maxZ = 38.0,
            minZ = 30.0
        },
    },

    {
        name = "roof_megamall",
        points = {
            vector2(70.45, -1718.18),
            vector2(18.94, -1776.89),
            vector2(84.47, -1833.71),
            vector2(99.62, -1815.53),
            vector2(93.94, -1809.47),
            vector2(104.17, -1800.38),
            vector2(121.59, -1815.53),
            vector2(151.14, -1778.41),
            vector2(134.47, -1764.77)
        },
        options = {
            maxZ = 37.0,
            minZ = 31.0
        },
    },

    {
        name = "roof_jamestownmotel",
        points = {
            vector2(559.47, -1765.53),
            vector2(549.62, -1781.82),
            vector2(562.12, -1791.29),
            vector2(570.08, -1777.65),
            vector2(570.83, -1770.45)
        },
        options = {
            maxZ = 37.0,
            minZ = 31.0
        },
    },

    {
        name = "roof_dome",
        points = {
            vector2(432.58, -1464.02),
            vector2(444.70, -1496.59),
            vector2(453.79, -1490.53),
            vector2(466.29, -1512.88),
            vector2(486.36, -1513.26),
            vector2(482.20, -1478.79),
            vector2(490.91, -1478.41),
            vector2(489.02, -1495.08),
            vector2(515.91, -1493.94),
            vector2(515.15, -1457.95),
            vector2(506.82, -1449.62),
            vector2(493.94, -1447.35),
            vector2(470.08, -1446.59),
            vector2(449.24, -1455.30)
        },
        options = {
            maxZ = 37.0,
            minZ = 30.0
        },
    }
}

CreateThread(function()
    Citizen.Wait(1)
    for _, zone in pairs(roofs) do
        exports["noob"]:AddPolyZone(
            zone.name,
            zone.points,
            {
                debugPoly = false,
                minZ = zone.options.minZ,
                maxZ = zone.options.maxZ
            }
        )
    end
end)


local inZone = false
local isShooting = false
local Wait = Wait

local DisableControlAction = DisableControlAction
local function disableClimbing()
    while inZone do
        if not isShooting then
            DisableControlAction(0, 22)
        end
        Wait(0)
    end
end

local enterHandler = nil
local exitHandler = nil

exports("disableRoofs", function(state)
    if enterHandler ~= nil then
        RemoveEventHandler(enterHandler)
        enterHandler = nil
    end

    if exitHandler ~= nil then
        RemoveEventHandler(exitHandler)
        exitHandler = nil
    end

    if state then
        RemoveIpl("southside_hosp_stairs_ipl")
        enterHandler = AddEventHandler("polyzone:enter", function(name)
            if name:find("roof_") then
                inZone = true
                disableClimbing()
            end
        end)
        
        exitHandler = AddEventHandler("polyzone:exit", function(name)
            if name:find("roof_") then
                inZone = false
            end
        end)
    else
        RequestIpl("southside_hosp_stairs_ipl")
    end
end)
